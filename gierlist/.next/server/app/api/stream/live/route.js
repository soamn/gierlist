"use strict";(()=>{var e={};e.id=32,e.ids=[32],e.modules={1185:e=>{e.exports=require("mongoose")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},8939:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>h,patchFetch:()=>y,requestAsyncStorage:()=>c,routeModule:()=>m,serverHooks:()=>g,staticGenerationAsyncStorage:()=>v});var s={};r.r(s),r.d(s,{GET:()=>d});var a=r(9303),n=r(8716),i=r(670),o=r(3646),u=r(3077),p=r(3338),l=r(7070);async function d(e){await (0,o.Z)();let{searchParams:t}=new URL(e.url,`https://${e.headers.host}`),r=t.get("of");try{let e;let t=await u.Z.findOne({_id:r}),s=await p.Z.findOne({user:t._id,status:!0}).populate({path:"user",select:"username"});if(!s)return l.NextResponse.json({success:!1});return e=`http://localhost:8000/live/${t.streamKey}/index.m3u8`,l.NextResponse.json({success:!0,mediaurl:e,stream:s},{status:200})}catch(e){return console.log(e),l.NextResponse.json({success:!1},{status:500})}}let m=new a.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/stream/live/route",pathname:"/api/stream/live",filename:"route",bundlePath:"app/api/stream/live/route"},resolvedPagePath:"C:\\Users\\negia\\Desktop\\gierlist\\gierlist\\app\\api\\stream\\live\\route.js",nextConfigOutput:"",userland:s}),{requestAsyncStorage:c,staticGenerationAsyncStorage:v,serverHooks:g}=m,h="/api/stream/live/route";function y(){return(0,i.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:v})}},3646:(e,t,r)=>{r.d(t,{Z:()=>o});var s=r(1185),a=r.n(s);let n=process.env.MONGODB_URI;if(!n)throw Error("Please define the MONGODB_URI environment variable inside .env.local");let i=global.mongoose;i||(i=global.mongoose={conn:null,promise:null});let o=async function(){return i.conn||(i.promise||(i.promise=a().connect(n,{bufferCommands:!1}).then(e=>e)),i.conn=await i.promise),i.conn}},3338:(e,t,r)=>{r.d(t,{Z:()=>i});var s=r(1185),a=r.n(s);let n=new(a()).Schema({streamName:{type:String,required:[!0,"Please provide a name"]},streamDescription:{type:String},status:{type:String,default:!1},user:{type:a().Schema.Types.ObjectId,ref:"User"}}),i=a().models.Stream||a().model("Stream",n)},3077:(e,t,r)=>{r.d(t,{Z:()=>i});var s=r(1185),a=r.n(s);let n=new(a()).Schema({username:{type:String,required:[!0,"Please provide a username"],unique:!0},email:{type:String,required:[!0,"Please provide an email"],unique:!0},password:{type:String,required:[!0,"Please provide a password"]},streamKey:{type:String,required:!0,unique:!0},stream:[{type:a().Schema.Types.ObjectId,ref:"Stream"}]}),i=a().models.User||a().model("User",n)}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[948,972],()=>r(8939));module.exports=s})();